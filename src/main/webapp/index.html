<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <!-- 强制让文档的宽度与设备的宽度保持1:1 -->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
    <!--禁止缩放-->
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="keywords" content="java,java博客,java学习,个人博客">
    <meta name="description" content="java,java博客,java学习,个人博客">

    <link rel="stylesheet" type="text/css" href="css/sui.nav.css"/>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="css/load.css">

<!--    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>-->
    <script src="js/jquery.min.js"></script>
<!--    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/sui.nav.min.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>
<div id="app">
    <!-- 头部 -->
    <header>
        <!-- navbar-fixed-top 固定在顶部 -->
        <nav class="navbar navbar-default inavbar-default navbar-fixed-top">
            <div class="container-fluid icontainer-fluid container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header inavbar-header">
                    <!-- data-toggle="collapse" -->
                    <button type="button" class="navbar-toggle collapsed icollapsed MenuToggle"
                            data-target="#bs-example-navbar-collapse-1"
                            aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <!-- logo -->
                    <a class="logo_a" href="/">
                        <img class="inavbar-brand" src="images/logo4.png" alt="">
                        <b>很方</b>
                    </a>

                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse  navbar-collapse" id="bs-example-navbar-collapse-1" style="margin-right: 50px;">

                    <ul class="nav navbar-nav  navbar-right">
                        <li v-if="user.head === undefined">
                            <a href="login.html">登录</a>
                        </li>

                        <li class="dropdown" v-show="user.head != undefined"
                            style="margin-right: -20px;margin-left: 10px;">
                            <!-- 通过data-delay设置下拉框消失的时间 -->
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown"
                               data-delay="50" role="button" aria-haspopup="true" aria-expanded="false"
                               style="padding: 5px 3px 5px 5px;">
                                <img :src="user.head" alt="头像" height="40" width="40" style="border-radius: 2em;">
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu idropdown-menu" style="margin-right: -104px;margin-top: 5px;">
                                <li><a href="personal.html"><span class="glyphicon glyphicon-user"></span> 我的主页</a></li>
                                <li><a href="personal.html#col"><span class="glyphicon glyphicon-list-alt"></span>收藏的文章</a></li>
                                <li><a href="personal.html#art"><span class="glyphicon glyphicon-copyright-mark"></span>我的文章</a></li>
                                <li role="separator" class="divider"></li>
<!--                                <li><a href="#"><span class="glyphicon glyphicon-registration-mark"></span>我是R</a></li>-->
<!--                                <li role="separator" class="divider"></li>-->
                                <li><a href="#" @click.prevent="exit"><span class="glyphicon glyphicon-log-out"></span>退出</a>
                                </li>
                            </ul>
                        </li>

                        <!-- <li><a href="#">注册</a></li> -->
                    </ul>


                    <form class="navbar-form navbar-right">
                        <div class="form-group">
                            <input type="text" v-model="q" class="form-control" placeholder="站内搜索">
                        </div>
                        <button type="submit" class="btn btn-default  glyphicon glyphicon-search" @click.prevent="artiAll"></button>
                    </form>

                    <ul class="nav navbar-nav navbar-right">
                        <li class="active"><a href="#"><span class="glyphicon glyphicon-home" style="font-size: 12px;"></span> 首页 </a></li>
                        <li><a href="articleeditor.html" target="_blank">
                            <span class="glyphicon glyphicon-pencil" style="font-size: 12px;"></span>
                            写文章</a></li>
                        <li><a href="#">Link1</a></li>
                        <li><a href="#">Link2</a></li>
                        <li class="dropdown">
                            <!-- 通过data-delay设置下拉框消失的时间 -->
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="50" role="button" aria-haspopup="true" aria-expanded="false">
                                <span class="glyphicon glyphicon-bookmark" style="font-size: 12px;"></span>
                                分类
                                <span class="caret"></span>
                            </a>

                            <ul class="dropdown-menu">
                                <li style="padding: 0 10px;">
                                    <span :class="l.id == lid ? 'badge sele' : 'badge'" v-for="l in label" :id="l.id" v-text="l.text" @click="lid = l.id" :key="l.id"></span>
                                    <span :class="lid == 0 ? 'badge sele' : 'badge'" @click="lid = 0">全部</span>
                                </li>
<!--                                <li role="separator" class="divider"></li>-->
<!--                                <li><a href="#">Another action</a></li>-->
<!--                                <li><a href="#">Something else here</a></li>-->
<!--                                <li role="separator" class="divider"></li>-->
<!--                                <li><a href="#">Separated link</a></li>-->
<!--                                <li role="separator" class="divider"></li>-->
<!--                                <li><a href="#">One more separated link</a></li>-->
                            </ul>
                        </li>

                    </ul>

                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->


            <!-- 侧边栏 -->
            <div id="sui_nav" class="sui-nav horizontal navbar-default">
                <div class="sui-nav-wrapper nav-border nav-line">
                    <ul>
                        <li>
                            <!-- logo -->
                            <a class="logo_a" href="#">
                                <img class="inavbar-brand" src="img/logo4.png" alt="">
                                <b>很方</b>
                            </a>
                        </li>

                        <li><a class="text-primary"><span class="glyphicon glyphicon-home"></span> 首页</a></li>
                        <li><a class="text-danger" href="articleeditor.html" onclick="event.stopPropagation()"><span class="glyphicon glyphicon-fire" ></span> 写文章</a></li>
                        <li>
                            <a href="#"><span class="glyphicon glyphicon-comment"></span>分类</a>
                            <span class="glyphicon glyphicon-hand-right" style="margin-left: 120px;"></span>
                            <ul >
                                <li style="padding: 0 10px;" class="fl">
                                    <span :class="l.id == lid ? 'badge sele' : 'badge'" v-for="l in label" :id="l.id" v-text="l.text" onclick="setLid(this)" :key="l.id"></span>
                                    <span :class="lid == 0 ? 'badge sele' : 'badge'"  id="0" onclick="setLid(this)">全部</span>
                                </li>


<!--                                <li><a href="#"><span class="glyphicon glyphicon-edit"></span> editor</a></li>-->
<!--                                <li><a href="#"><span class="glyphicon glyphicon-pencil"></span> pencil</a></li>-->
<!--                                <li><a href="#"><span class="glyphicon glyphicon-saved"></span> Level23</a>-->
<!--                                    <span class="indicator">-->
<!--												<span class="glyphicon glyphicon-hand-right"-->
<!--                                                      style="margin-left: -30px;"></span>-->
<!--											</span>-->

<!--                                    <ul>-->
<!--                                        <li><a href="#">Level31</a></li>-->
<!--                                        <li><a href="#">Level32</a></li>-->
<!--                                        <li class="hide-in-horizontal"><a href="#">Level33</a>-->
<!--                                            <ul>-->
<!--                                                <li><a href="#">Level331</a></li>-->
<!--                                                <li><a href="#">Level332</a></li>-->
<!--                                                <li><a href="#">Level333</a></li>-->
<!--                                                <li><a href="#">Level334</a></li>-->
<!--                                            </ul>-->
<!--                                            <span class="indicator">-->
<!--														<span class="glyphicon glyphicon-hand-right"></span>-->
<!--													</span>-->
<!--                                        </li>-->

<!--                                        <li class="hide-in-horizontal"><a href="#">Level34</a>-->
<!--                                            <ul>-->
<!--                                                <li><a href="#">Level331</a></li>-->
<!--                                                <li><a href="#">Level332</a></li>-->
<!--                                                <li><a href="#">Level333</a></li>-->
<!--                                                <li><a href="#">Level334</a></li>-->
<!--                                            </ul>-->
<!--                                            <span class="indicator">-->
<!--														<span class="glyphicon glyphicon-hand-right"></span>-->
<!--													</span>-->
<!--                                        </li>-->
<!--                                        <li><a href="#">Level34</a></li>-->
<!--                                    </ul>-->
<!--                                </li>-->
<!--                                -->
<!--                                <li><a href="#"><span class="glyphicon glyphicon-save"></span> Level24</a></li>-->

                            </ul>
                        </li>
                    </ul>

                    <ul class="pull-right">
                        <!--头像-->
                        <li v-if="user.head === undefined">
                            <a class="text-success" onclick="event.stopPropagation()" href="login.html">登录</a>
                        </li>
                        <li v-else>
                            <img :src="user.head" alt="头像" height="45" width="45"
                                 style="border-radius: 2em;margin-left: 10px;">
                            <span class="glyphicon glyphicon-hand-right" style="margin-left: 120px;"></span>
                            <!--下拉-->
                            <ul>
                                <li><a href="personal.html" onclick="event.stopPropagation()"><span class="glyphicon glyphicon-user"></span> 我的主页</a></li>
                                <li><a href="personal.html#col" onclick="event.stopPropagation()"><span class="glyphicon glyphicon-list-alt"></span> 收藏的文章</a></li>
                                <li><a href="personal.html#art" onclick="event.stopPropagation()"><span class="glyphicon glyphicon-copyright-mark"></span> 我的文章</a></li>
<!--                                <li><a href="#"><span class="glyphicon glyphicon-registration-mark"></span> 我是R</a></li>-->
                                <li><a href="#" onclick="exit()" ><span class="glyphicon glyphicon-log-out"></span> 退出</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </div>
        </nav>
    </header>


    <!-- 主体 -->
    <section class="main">
        <!-- 左侧 -->
        <div class="l">
            <!-- 轮播图 -->
            <div id="myCarousel" class="carousel slide">
                <!-- 轮播（Carousel）指标 -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#myCarousel" data-slide-to="1"></li>
                    <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>
                <!-- 轮播（Carousel）项目 -->
                <div class="carousel-inner">
                    <div class="item active">
                        <img src="img/C1.png" alt="First slide">
                        <div class="carousel-caption">标题1</div>
                    </div>
                    <div class="item">
                        <img src="img/C2.png" alt="Second slide">
                        <div class="carousel-caption">标题2</div>
                    </div>
                    <div class="item">
                        <img src="img/C3.png" alt="Third slide">
                        <div class="carousel-caption">标题3</div>
                    </div>
                </div>
                <!-- 轮播（Carousel）导航 -->
                <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

            <!-- 博文 -->
            <div style="margin-top: 20px;">

                <select name="" id="" style="float: right" v-model="sort">
                    <option value="1">时间</option>
                    <option value="2">热度</option>
                    <option value="3" v-if="user.head != undefined">关注</option>
                    <option value="4">随机</option>
                </select>
                <br>

                <!-- 加载动画 -->
                <div>
                    <div class="icontainer animation-6">
                        <div class="shape shape1"></div>
                        <div class="shape shape2"></div>
                        <div class="shape shape3"></div>
                        <div class="shape shape4"></div>
                    </div>
                </div>


                <!-- 右对齐 -->
                <div class="media imedia  iimg" v-for="article in pageResult.items" :key="article.aid">
                    <div class="media-body">
                        <a :href="joint(article.aid)" target="_blank"><h4 class="media-heading"><b
                                v-text="article.title">标题</b></h4></a>
                        <p v-text="article.describe"></p>
                        <br v-if="article.describe == undefined || article.describe.length==0" >
                        <span class="span_a"><i class="glyphicon glyphicon-time"></i><span
                                v-text="formatDate(article.releasetime)">2020-03-21 17:04:50</span> </span>
                        <span class="span_b"><i class="glyphicon glyphicon-eye-open"></i><span
                                v-text="article.pageview">1亿</span></span>
                        <span class="span_c" v-text="article.username">囧囧</span>
                    </div>
                    <div class="media-right" v-if="article.imgPath != null" >
                        <a :href="joint(article.aid)" target="_blank">  <img :src="article.imgPath" class="media-object" height="100" style="width:120px;height:100px;margin-top:-20px;border: 1px solid #f0f0f0;"></a>
                    </div>
                    <div class="media-right" style="border: none;" v-show="article.imgPath == null">
                        <span style="width:120px;display:inline-block;height:100px;margin-top:-20px;"></span>
                    </div>
                </div>


            </div>

        </div>

        <!-- 右侧 -->
        <div class="r">

            <div class="panel panel-default">
                <div class="panel-heading ipanel-heading ">
                    <h3 class="panel-title">
                        <b>关于站长</b>
                    </h3>
                </div>
                <div class="panel-body iregard">
                    <!-- github -->
                    <a href="https://github.com/Birthaa" class="imessage" target="_blank" title="github">
                        <img src="img/github.png">
                        <p>github</p>
                    </a>
                    <!-- qq -->
                    <a href="tencent://message/?uin=2879823308&Site=&Menu=yes" class="imessage2" title="2879823308">
                        <img src="img/qq.png">
                        <p>QQ</p>
                    </a>

                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading ipanel-heading ">
                    <h3 class="panel-title">
                        <b>热门文章</b>
                    </h3>
                </div>
                <div class="panel-body ihot">
                    <ul>
                        <li v-for="article in hot" :key="article.aid"><a :href="joint(article.aid)" target="_blank" v-text="article.title"></a></li>
                    </ul>
                </div>
            </div>


            <div class="panel panel-default">
                <div class="panel-heading ipanel-heading ">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-tag" style="font-size: 13px;"></span> <b>热门标签</b>
                    </h3>
                </div>
                <div class="panel-body ipanel-body">
                    <span :class="randomColor()" v-for="label in hotLabel" :key="label.id" v-text="label.text">Java</span>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading ipanel-heading ">
                    <h3 class="panel-title">
                        <b>最近访客</b>
                    </h3>
                </div>
                <div class="panel-body ipanel-body">
                    {{visitor}}
                </div>
            </div>

        </div>
    </section>

<!--    右边悬浮-->
    <div class="back-to-the-top">
        <i class="glyphicon glyphicon-chevron-up"></i>
        <i class="glyphicon glyphicon-chevron-down"></i>
    </div>


    <!-- 尾部 -->
    <footer class="itail">
        <div class="container">
            <span v-text="formatDate(1584781490036)"></span>
            假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾假结尾
        </div>
    </footer>

</div>

<script src="http://cdn.bootcss.com/bootstrap-hover-dropdown/2.0.10/bootstrap-hover-dropdown.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="js/axios.min.js"></script>



<script>
    var page = 2;
    var colorClass = ["label-primary","label-success","label-info","label-warning","label-danger"];
    var vueApp = new Vue({
        el: "#app",
        data: {
            user: {},
            visitor: "tanyun",
            pageResult: {},
            label:[],
            lid: 0,
            q: '',
            hot: [],
            sort: '1',
            hotLabel: []
        },
        watch:{
            lid(nVal,oVal){
                this.artiAll();
            },
            sort(nVal,oVal){
                this.artiAll();
            },
            pageResult(nval,oval){
                $(".icontainer").css("display","none");

            }
        },
        methods: {
            exit: function () {
                var _this = this;
                axios.get("user/exit").then(function (resp) {
                    if (resp.status === 200) {
                        _this.user = {};
                    }
                })
            },
            randomColor: function(){
                // alert(colorClass[0]);

                return "label " + colorClass[Math.floor(Math.random()*colorClass.length)];
            },
            formatDate: function (value) {
                let date = new Date(value);
                let y = date.getFullYear();
                let MM = date.getMonth() + 1;
                MM = MM < 10 ? ('0' + MM) : MM;
                let d = date.getDate();
                d = d < 10 ? ('0' + d) : d;
                let h = date.getHours();
                h = h < 10 ? ('0' + h) : h;
                let m = date.getMinutes();
                m = m < 10 ? ('0' + m) : m;
                let s = date.getSeconds();
                s = s < 10 ? ('0' + s) : s;
                return y + '-' + MM + '-' + d + ' ' + h + ':' + m + ':' + s;
            },
            joint: function (id) {
                return "detail.html?id=" + id;
            },
           CheckIsNullOrEmpty: function(value) {
                //正则表达式用于判斷字符串是否全部由空格或换行符组成
                var reg = /^\s*$/
                //返回值为true表示不是空字符串
                return (value != null && value != undefined && !reg.test(value))
            },
            artiAll: function () {
                var _this = this;
                page = 2;
                /*获得全部文章*/
                axios.get("article/all?"+(_this.lid==0 ? '' : 'lid='+_this.lid+"&") + (_this.CheckIsNullOrEmpty(_this.q) ? 'q='+_this.q + "&": '') + "sort="+_this.sort).then(function (resp) {
                    _this.pageResult = resp.data;
                }).catch(function (error) {

                });
            }

        },
        created: function () {
            $(".iimg").removeClass('iimg');

            const _this = this;
            // console.log(132456);
            axios.get("user/thelogin").then(function (value) {

                _this.user = value.data;
            }).catch(function (error) {

            });

            this.artiAll();

            //分类
            axios.get("label").then(function (resp) {
                _this.label = resp.data;
            });

            //热门
            axios.get("article/hot").then(function (resp) {
                _this.hot = resp.data;
            })


            //热门标签
            axios.get("hotlabel").then(function (resp) {
                _this.hotLabel = resp.data;
            })

            window.onscroll = function () {
                //变量scrollTop是滚动条滚动时，距离顶部的距离
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                //变量windowHeight是可视区的高度
                var windowHeight = document.documentElement.clientHeight || document.body.clientHeight;
                //变量scrollHeight是滚动条的总高度
                var scrollHeight = document.documentElement.scrollHeight || document.body.scrollHeight;

                if (scrollTop + windowHeight > 1500) {
                    $(".back-to-the-top .glyphicon-chevron-up").css("display", "block");
                } else {
                    $(".back-to-the-top .glyphicon-chevron-up").css("display", "none");
                }

                //滚动条到底部的条件
                if (scrollTop + windowHeight == scrollHeight) {
                    //写后台加载数据的函数
                    //页码小于或者等于总页数才去查询
                    if (page <= _this.pageResult.totalPage) {

                        axios.get("article/all?page=" + page + (_this.lid==0 ? '' : '&lid='+_this.lid) + (_this.CheckIsNullOrEmpty(_this.q) ? '&q='+_this.q : '') + "&sort=" + _this.sort).then(function (resp) {
                            var pageResult = _this.pageResult;
                            pageResult.total = resp.data.total;
                            pageResult.totalPage = resp.data.totalPage;
                            pageResult.items = pageResult.items.concat(resp.data.items);
                            _this.pageResult = pageResult;

                            ++page;
                        }).catch(function (error) {

                        });
                    }

                }
            }

        }

    });


    // document.write(document.getElementById('sui_nav').innerHTML);
    var topbar;
    $(function () {

        topbar = $('#sui_nav').SuiNav({});

        var navbar = $('#sui_nav2').SuiNav({});
        $('.MenuToggle').click(function () {
            console.log("toggle");
            topbar.toggle();
        });
        $('.MenuOpen').click(function () {
            console.log("open");
            topbar.show();
        });

        // 控制轮播
        $('.carousel').carousel({
            interval: 4000, // 轮播速度
            pause: "hover", // 移入是否停止轮播 null 不停止
        })

    });

    /* 去顶部 */
    $('.back-to-the-top .glyphicon-chevron-up').on('click', function () {
        $('html,body').animate({
            scrollTop: 0
        }, 'slow'); //缓慢动画
    });

    /* 去底部 */
    $('.back-to-the-top .glyphicon-chevron-down').on('click', function () {
        /* $('html,body,#box').scrollTop(9999); */
        $('html,body').animate({
			scrollTop: $('.itail').offset().top
        }, 'slow');
    });

    function exit() {
        vueApp.exit();
        location.reload(false);
    }


    function setLid(d) {
        var id = $(d).attr("id");
        $(d).parent().children('span').each(function (i, v) {
            $(v).removeClass("sele");
        });
        $(d).addClass("sele");

        vueApp.lid = id;
    }
</script>


</body>

</html>
